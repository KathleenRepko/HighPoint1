define(function (require) {
  /* eslint no-var:0 */
  var _ = require('underscore');

  // Simple utility to determine type of credit card
  // based on credit card starting number/numbers

  var patterns = {
    visa: new RegExp('^4'),
    amex: new RegExp('^3[47]'),
    discover: new RegExp('^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)'),
    master: new RegExp('^(5[0-5]|2((22[1-9])|(2[3-9])|[3-6]|(7[0-2]0)))')
  };

  var cardNames = {
    'visa': 'Visa',
    'amex': 'American Express',
    'discover': 'Discover',
    'master': 'Mastercard',
    'undefined': 'Credit Card'
  };

  return {
    getCreditCardType: function (creditCardNumber) {
      return _.findKey(patterns, function (pattern) {
        return pattern.test(creditCardNumber);
      });
    },

    getCreditCardName: function (pattern) {
      return cardNames[pattern] || cardNames.undefined;
    }
  };
});
